(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),l=a.n(c),o=(a(89),a(25)),s=a(26),u=a(35),i=a(34),m=(a(90),a(91),a(51)),h=a(105),p=a(110),d=a(41),f=r.a.createContext({authUser:{}}),E=a(18),g=a(79),b=a.n(g),v=function(e){return r.a.createElement(f.Consumer,null,(function(t){return r.a.createElement(m.a,{style:{backgroundColor:"black"},variant:"dark",expand:"sm"},r.a.createElement(m.a.Toggle,{"aria-controls":"left-sidebar","aria-expanded":"false","aria-label":"Toggle sidebar",onClick:e.showSidebar}),r.a.createElement(m.a.Brand,null,r.a.createElement(h.a,{style:{width:"50px"},src:b.a})),r.a.createElement(p.a,{className:"ml-md-auto"},t.authUser&&r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a.Brand,null,"Welcome ",t.authUser.username,"!"),r.a.createElement(p.a.Link,{onClick:function(e){e.preventDefault(),t.logoutUser()}},"Logout")),!t.authUser&&r.a.createElement(E.c,{as:E.c,className:"mr-2",to:"/login"},r.a.createElement(d.a,{type:"button",variant:"outline-light"},"LOGIN")),r.a.createElement(E.c,{className:"mr-2",to:"/"},r.a.createElement(d.a,{type:"button",variant:"outline-light"},"Home")),r.a.createElement(E.c,{className:"mr-2",to:"/map"},r.a.createElement(d.a,{type:"button",variant:"outline-light"},"MAP"))))}))},y=a(9),w=a.n(y),k=a(19),j=a(111),O=a(15),S=a(106),C=a(107),x=a(83),N=a(82),U=a(108),P=a(109),L=a(57),B=a.n(L),T=a(81),F=a.n(T);function I(){return(I=Object(k.a)(w.a.mark((function e(){var t,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/user",e.next=3,fetch("/api/user");case 3:return t=e.sent,e.next=6,t.json();case 6:if(a=e.sent,!t.ok){e.next=11;break}return e.abrupt("return",a);case 11:throw{status:t.status,errObj:a};case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(k.a)(w.a.mark((function e(t){var a,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/map",e.next=3,fetch("/api/map"+"?lat=".concat(t.lat,"&lng=").concat(t.lng));case 3:return a=e.sent,e.next=6,a.json();case 6:if(n=e.sent,!a.ok){e.next=11;break}return e.abrupt("return",n);case 11:throw{status:a.status,errObj:n};case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(k.a)(w.a.mark((function e(t,a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})}).then((function(t){t.ok?t.json().then((function(t){e(t)})):t.json().then((function(e){n(e)})).catch((function(e){n({errors:[{param:"Application",msg:"Cannot parse server response"}]})}))})).catch((function(e){n({errors:[{param:"Server",msg:"Cannot communicate"}]})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(k.a)(w.a.mark((function e(t,a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){fetch("/api/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:a})}).then((function(t){t.ok?t.json().then((function(){e()})):t.json().then((function(e){n(e)})).catch((function(e){n({errors:[{param:"Application",msg:"Cannot parse server response"}]})}))})).catch((function(e){n({errors:[{param:"Server",msg:"Cannot communicate"}]})}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return(G=Object(k.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){fetch("/api/logout",{method:"POST"}).then((function(a){a.ok?e(null):a.json().then((function(e){t(e)})).catch((function(e){t({errors:[{param:"Application",msg:"Cannot parse server response"}]})}))}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=Object(k.a)(w.a.mark((function e(){var t,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/bicycles",e.next=3,fetch("/api/bicycles");case 3:return t=e.sent,e.next=6,t.json();case 6:if(a=e.sent,!t.ok){e.next=11;break}return e.abrupt("return",a);case 11:throw{status:t.status,errObj:a};case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H={isAuthenticated:function(){return I.apply(this,arguments)},userLogin:function(e,t){return D.apply(this,arguments)},userLogout:function(){return G.apply(this,arguments)},getBicycles:function(){return q.apply(this,arguments)},getMapData:function(e){return A.apply(this,arguments)},userSignup:function(e,t){return M.apply(this,arguments)}},J=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={search:"",bicycles:[],result:[],submitting:!0,searched:!1,show:!1,type:"Bike shop"},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.getBicycles();case 2:t=e.sent,this.setState({bicycles:t,submitting:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleSearch",value:function(){var e=this,t={"Bike shop":"store",Bike:"name","Location City":"addr"},a=this.state.bicycles.filter((function(a){return a[t[e.state.type]].includes(e.state.search)}));this.setState({result:a,searched:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement(f.Consumer,null,(function(t){return r.a.createElement(r.a.Fragment,null,e.state.submitting?r.a.createElement(j.a,{variant:"dark",animated:!0,now:100}):"",r.a.createElement(O.a,{style:{textAlign:"center"},className:"mt-5",onSubmit:e.placeOrder},r.a.createElement(O.a.Group,null,r.a.createElement(S.a,{size:"lg",style:{width:"60vw",margin:"0px auto"},className:"mb-3"},r.a.createElement(C.a,{as:S.a.Prepend,variant:"outline-light",title:e.state.type,id:"input-group-dropdown"},r.a.createElement(x.a.Item,{onClick:function(t){t.preventDefault(),e.setState({type:"Bike shop"})}},"Bike shop"),r.a.createElement(x.a.Item,{onClick:function(t){t.preventDefault(),e.setState({type:"Bike"})}},"Bike"),r.a.createElement(x.a.Item,{onClick:function(t){t.preventDefault(),e.setState({type:"Location City"})}},"Location City")),r.a.createElement(N.a,{placeholder:"Search",value:e.state.search,onChange:function(t){return e.setState({search:t.target.value})}}),r.a.createElement(S.a.Append,null,r.a.createElement(d.a,{onClick:function(){return e.handleSearch()},variant:"outline-light"},"Search")))),!e.state.searched&&r.a.createElement("div",{className:"position-relative"},r.a.createElement("div",{className:"position-absolute",style:{width:"100vw",margin:"0 auto",color:"white",top:"30%"}},r.a.createElement("h3",null,"Look at a bike shop near you")),r.a.createElement(h.a,{src:B.a,fluid:!0}))),r.a.createElement(U.a,{striped:!0,bordered:!0,hover:!0,variant:"dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Bike shop"),r.a.createElement("th",null,"Bike"),r.a.createElement("th",null,"Price"),r.a.createElement("th",null,"Location City"))),r.a.createElement("tbody",null,e.state.searched?e.state.result.map((function(e,t){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.store),r.a.createElement("td",null,e.name),r.a.createElement("td",null,"$",e.price),r.a.createElement("td",null,e.addr),r.a.createElement("td",null,r.a.createElement("a",{target:"_blank",className:"btn btn-outline-light",href:e.link},"Link")))})):e.state.bicycles.map((function(e,t){return r.a.createElement("tr",{key:e.name},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.store),r.a.createElement("td",null,e.name),r.a.createElement("td",null,"$",e.price),r.a.createElement("td",null,e.addr),r.a.createElement("td",null,r.a.createElement("a",{target:"_blank",className:"btn btn-outline-light",href:e.link},"Link")))})))),e.state.searched&&0===e.state.result.length&&r.a.createElement("h3",{className:"text-center",style:{color:"white"}},"No data"),r.a.createElement("div",{className:"position-relative"},r.a.createElement("div",{className:"position-absolute",style:{right:"10px",top:"40%",color:"white",width:"20vw"}},r.a.createElement("h3",null," Find your favorite bike here"),r.a.createElement(E.b,{to:"/map"},r.a.createElement(d.a,{variant:"outline-light"},"Find More"))),r.a.createElement(h.a,{src:F.a,fluid:!0})),r.a.createElement(P.a,{show:e.state.show,onHide:e.handleClose,backdrop:"static",keyboard:!1},r.a.createElement(P.a.Header,{closeButton:!0},r.a.createElement(P.a.Title,null)),r.a.createElement(P.a.Body,null,"You order has been processed! Thank you!!")))}))}}]),a}(r.a.Component),W=a(65),_=a(66),z=a(43),$=a(67),Q=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChangeUsername=function(e){n.setState({username:e.target.value})},n.onChangePassword=function(e){n.setState({password:e.target.value})},n.handleSubmit=function(){var e=Object(k.a)(w.a.mark((function e(t,a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a(n.state.username,n.state.password),n.setState({submitted:!0});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.state={username:"",password:"",submitted:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(f.Consumer,null,(function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{style:{color:"white"},fluid:!0},r.a.createElement(_.a,null,r.a.createElement(z.a,null,r.a.createElement("h2",{className:"ui teal image header"},r.a.createElement("div",{className:"content"},"Log in to your account")),r.a.createElement(O.a,{method:"POST",onSubmit:function(a){return e.handleSubmit(a,t.loginUser)}},r.a.createElement(O.a.Group,{controlId:"username"},r.a.createElement(O.a.Label,null,"Username"),r.a.createElement(O.a.Control,{type:"text",name:"username",placeholder:"Username",value:e.state.username,onChange:function(t){return e.onChangeUsername(t)},required:!0,autoFocus:!0})),r.a.createElement(O.a.Group,{controlId:"password"},r.a.createElement(O.a.Label,null,"Password"),r.a.createElement(O.a.Control,{type:"password",name:"password",placeholder:"Password",value:e.state.password,onChange:function(t){return e.onChangePassword(t)},required:!0})),r.a.createElement(d.a,{variant:"outline-light",type:"submit"},"Login"),r.a.createElement("br",null),r.a.createElement("div",{className:"mt-2"},r.a.createElement("span",null,"Dose not have a acount? ",r.a.createElement(E.b,{to:"/signup"},"create account")))),t.authErr&&r.a.createElement($.a,{variant:"danger mt-5"},t.authErr.msg)))))}))}}]),a}(r.a.Component),R=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChangeUsername=function(e){n.setState({username:e.target.value})},n.onChangePassword=function(e){n.setState({password:e.target.value})},n.handleSubmit=function(){var e=Object(k.a)(w.a.mark((function e(t,a){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a(n.state.username,n.state.password),n.setState({submitted:!0});case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),n.state={username:"",password:"",submitted:!1},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(f.Consumer,null,(function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{style:{color:"white"},fluid:!0},r.a.createElement(_.a,null,r.a.createElement(z.a,null,r.a.createElement("h2",{className:"ui teal image header"},r.a.createElement("div",{className:"content"},"Create a new account")),r.a.createElement(O.a,{method:"POST",onSubmit:function(a){return e.handleSubmit(a,t.signUpUser)}},r.a.createElement(O.a.Group,{controlId:"username"},r.a.createElement(O.a.Label,null,"Username"),r.a.createElement(O.a.Control,{type:"text",name:"username",placeholder:"Username",value:e.state.username,onChange:function(t){return e.onChangeUsername(t)},required:!0,autoFocus:!0})),r.a.createElement(O.a.Group,{controlId:"password"},r.a.createElement(O.a.Label,null,"Password"),r.a.createElement(O.a.Control,{type:"password",name:"password",placeholder:"Password",value:e.state.password,onChange:function(t){return e.onChangePassword(t)},required:!0})),r.a.createElement(d.a,{variant:"outline-light",type:"submit"},"Sign UP")),t.authErr&&r.a.createElement($.a,{variant:"danger mt-5"},t.authErr.msg)))))}))}}]),a}(r.a.Component),K=a(7),V=a(68),X=a(76),Y=a(31),Z=a(52);var ee=function(){var e=Object(n.useState)(null),t=Object(Y.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)({}),o=Object(Y.a)(l,2),s=o[0],u=o[1],i=Object(n.useState)({lat:43.65107,lng:-79.347015}),m=Object(Y.a)(i,2),p=m[0],d=m[1],f=Object(n.useState)(5),E=Object(Y.a)(f,2),g=E[0],b=E[1],v=Object(n.useState)(!1),y=Object(Y.a)(v,2),w=y[0],k=y[1],j=Object(n.useState)([]),O=Object(Y.a)(j,2),S=O[0],C=O[1],x=Object(n.useState)(null),N=Object(Y.a)(x,2),U=(N[0],N[1]),P=Object(n.useState)(!0),L=Object(Y.a)(P,2),T=L[0],F=L[1];Object(n.useEffect)((function(){var e=navigator.geolocation;if(e){var t=e.getCurrentPosition(I,D,{timeout:1e4});return function(){return e.clearWatch(t)}}console.log("Geolocation is not supported")}),[]);var I=function(e){var t=e.coords;d({lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)}),A(t.latitude,t.longitude),F(!1)},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:43.65107,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-79.347015,a={lat:e,lng:t};console.log(a),H.getMapData(a).then((function(e){C(e)}))},D=function(e){A(),F(!1),alert("Can't get your location this time. The default loaction is Toronto"),console.log(e.message)},M=Object(Z.d)({googleMapsApiKey:"AIzaSyCqIAlQpyecPGoONZ1w4CMQLgBtmdeRS_A"}).isLoaded,G=function(e){U(e)};return M?r.a.createElement(r.a.Fragment,null,T&&r.a.createElement("span",{style:{color:"white"}},"Getting your location..."),r.a.createElement("h3",{style:{color:"white"}},"Find Bicycle Stores near you"),r.a.createElement(Z.a,{onLoad:G,center:p,zoom:13,mapContainerStyle:{height:"70vh",width:"100%"}},S.map((function(e){return r.a.createElement(Z.c,{key:e.id,position:e.pos,onLoad:function(t){return function(e,t){return u((function(a){return Object(X.a)(Object(X.a)({},a),{},Object(V.a)({},t.id,e))}))}(t,e)},onClick:function(t){return function(e,t){c(t),w&&k(!1),k(!0),g<13&&b(13)}(0,e)}})})),w&&a&&r.a.createElement(Z.b,{anchor:s[a.id],onCloseClick:function(){return k(!1)}},r.a.createElement("div",null,r.a.createElement("h6",null,a.name),r.a.createElement("div",null,"Rating: ",a.rating),r.a.createElement("div",null,"Open now: ",a.open_now?"Open":"Close"),r.a.createElement("div",null,a.vicinity," ")))),r.a.createElement("div",{className:"position-relative"},r.a.createElement(h.a,{src:B.a,fluid:!0}))):null},te=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).logout=function(){console.log("logout"),H.userLogout().then((function(){n.setState({authUser:null,authErr:null})}))},n.login=function(e,t){H.userLogin(e,t).then((function(e){n.setState({authUser:e,authErr:null}),n.props.history.push("/")})).catch((function(e){console.log(e);var t=e.errors[0];n.setState({authErr:t})}))},n.signup=function(e,t){H.userSignup(e,t).then((function(){n.props.history.push("/login")})).catch((function(e){console.log(e);var t=e.errors[0];n.setState({authErr:t})}))},n.state={},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;H.isAuthenticated().then((function(t){e.setState({authUser:t})})).catch((function(t){e.setState({authErr:t.errorObj})}))}},{key:"render",value:function(){var e={authUser:this.state.authUser,authErr:this.state.authErr,loginUser:this.login,logoutUser:this.logout,signUpUser:this.signup};return r.a.createElement(f.Provider,{value:e},r.a.createElement(v,{showSidebar:this.showSidebar,getPublicTasks:this.getPublicTasks}),r.a.createElement(W.a,{fluid:!0},r.a.createElement(K.d,null,r.a.createElement(K.b,{path:"/login"},r.a.createElement(_.a,{className:"vheight-100"},r.a.createElement(z.a,{sm:4}),r.a.createElement(z.a,{sm:4,className:"below-nav"},r.a.createElement(Q,null)))),r.a.createElement(K.b,{path:"/signup"},r.a.createElement(_.a,{className:"vheight-100"},r.a.createElement(z.a,{sm:4}),r.a.createElement(z.a,{sm:4,className:"below-nav"},r.a.createElement(R,null)))),r.a.createElement(K.b,{path:"/map"},r.a.createElement(_.a,{className:"vheight-100"},r.a.createElement(z.a,{sm:12,className:"below-nav"},r.a.createElement(ee,null)))),r.a.createElement(K.b,{path:"/"},r.a.createElement(_.a,{className:"vheight-100"},r.a.createElement(z.a,{sm:12,className:"below-nav"},r.a.createElement(J,null)))),r.a.createElement(K.b,null,r.a.createElement(K.a,{to:"/"})))))}}]),a}(r.a.Component),ae=Object(K.g)(te);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(E.a,null,r.a.createElement(ae,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,t,a){e.exports=a.p+"static/media/josh-nuttall-eTrHMJwI5ro-unsplash.1a1ebdbe.jpg"},79:function(e,t,a){e.exports=a.p+"static/media/logo.50221709.png"},81:function(e,t,a){e.exports=a.p+"static/media/josh-nuttall-XVTWFHcNIko-unsplash.13778c30.jpg"},84:function(e,t,a){e.exports=a(100)},89:function(e,t,a){},90:function(e,t,a){}},[[84,1,2]]]);
//# sourceMappingURL=main.7b92f709.chunk.js.map